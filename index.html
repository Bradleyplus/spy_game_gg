
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undercover - Web Spy Game</title>
    <script>
      // 1. å…¨å±€å¼‚å¸¸ç›‘æŽ§
      window.onerror = function(msg, source, lineno, colno, error) {
        console.error('Global Error:', msg);
        var errorDisplay = document.getElementById('debug-error-display');
        if (!errorDisplay) {
            errorDisplay = document.createElement('div');
            errorDisplay.id = 'debug-error-display';
            errorDisplay.style.cssText = 'position:fixed; top:0; left:0; width:100%; height:100%; background:#0f172a; color:#f87171; padding:30px; z-index:100000; font-family:monospace; overflow:auto;';
            document.documentElement.appendChild(errorDisplay);
        }
        errorDisplay.innerHTML = '<h1 style="color:white;font-size:24px;margin-bottom:20px;">SYSTEM BOOT ERROR</h1>' +
                                 '<p style="background:#7f1d1d;padding:15px;border-radius:8px;color:white;word-break:break-all;">' + (error ? error.stack : msg) + '</p>' +
                                 '<div style="margin-top:20px;color:#94a3b8;font-size:12px;">' +
                                 'Source: ' + source + '<br>Location: ' + lineno + ':' + colno + '</div>' +
                                 '<button onclick="location.reload()" style="margin-top:20px;padding:12px 24px;background:#4f46e5;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:bold;">RETRY CONNECTION</button>';
        return false;
      };

      // 2. è¶…æ—¶æ£€æµ‹ (15ç§’)
      window.loadTimer = setTimeout(function() {
          const root = document.getElementById('root');
          if (root && root.querySelector('.boot-loader')) {
              console.warn('Bootloader timed out. Likely ImportMap failure.');
              root.innerHTML = `
                <div style="height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px; background:#020617;">
                    <div style="font-size:48px; margin-bottom:20px;">ðŸ“¡</div>
                    <h2 style="color:#f87171; font-weight:900; margin-bottom:10px;">CONNECTION TIMEOUT</h2>
                    <p style="color:#94a3b8; max-width:400px; font-size:14px; margin-bottom:30px;">
                        The application is taking too long to initialize.<br><br>
                        <b>Possible Cause:</b> Your browser or network blocked the CDN resources.<br>
                        Wait a few seconds or try the button below.
                    </p>
                    <button onclick="location.reload()" style="padding:12px 24px; background:#1e293b; color:white; border:1px solid #334155; border-radius:12px; font-weight:bold; cursor:pointer;">FORCE REFRESH</button>
                    <div style="margin-top:20px; font-size:10px; color:#334155;">Error logged to console (F12)</div>
                </div>`;
          }
      }, 15000);
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f8fafc; margin: 0; overflow-x: hidden; min-height: 100vh; }
        .boot-loader { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }
        .glass-card { background: rgba(30, 41, 59, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "@google/genai": "https://esm.sh/@google/genai@1.34.0",
    "leancloud-storage": "https://esm.sh/leancloud-storage@4.15.0",
    "leancloud-realtime": "https://esm.sh/leancloud-realtime@5.0.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
    <script>window.process = { env: { API_KEY: "" } };</script>
</head>
<body>
    <div id="root">
        <div class="boot-loader">
            <div style="width: 40px; height: 40px; border: 3px solid #4f46e5; border-top-color: transparent; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
            <p style="margin-top: 20px; font-weight: 900; letter-spacing: 0.4em; color: #4f46e5; font-size: 10px; text-transform: uppercase;">Initializing Neural Link...</p>
        </div>
    </div>
    <script type="module" src="./index.tsx"></script>
</body>
</html>
