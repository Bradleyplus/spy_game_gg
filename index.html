
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Undercover - Web Spy Game</title>
    <script>
      // 1. å…¨å±€é”™è¯¯æ•è·æœºåˆ¶ (æ”¾åœ¨æœ€é¡¶éƒ¨)
      window.onerror = function(msg, source, lineno, colno, error) {
        var errorDisplay = document.getElementById('debug-error-display');
        if (!errorDisplay) {
            errorDisplay = document.createElement('div');
            errorDisplay.id = 'debug-error-display';
            errorDisplay.style.cssText = 'position:fixed; top:0; left:0; width:100%; height:100%; background:#0f172a; color:#f87171; padding:30px; z-index:100000; font-family:monospace; overflow:auto;';
            document.documentElement.appendChild(errorDisplay);
        }
        errorDisplay.innerHTML = '<h1 style="color:white;font-size:24px;margin-bottom:20px;">CRITICAL SCRIPT ERROR</h1>' +
                                 '<p style="background:#7f1d1d;padding:15px;border-radius:8px;color:white;">' + msg + '</p>' +
                                 '<ul style="list-style:none;padding:0;margin-top:20px;color:#94a3b8;font-size:12px;">' +
                                 '<li>File: ' + source + '</li>' +
                                 '<li>Line: ' + lineno + ':' + colno + '</li>' +
                                 '</ul>' +
                                 '<button onclick="location.reload()" style="margin-top:20px;padding:10px 20px;background:#4f46e5;color:white;border:none;border-radius:8px;cursor:pointer;">FORCE RELOAD</button>';
        return false;
      };

      // 2. åŠ è½½è¶…æ—¶æ£€æµ‹ (8ç§’)
      window.loadTimer = setTimeout(function() {
          const root = document.getElementById('root');
          // å¦‚æœ root é‡Œé¢è¿˜æ˜¯åŠ è½½åŠ¨ç”»ï¼ˆè¯´æ˜ React æ²¡èƒ½æˆåŠŸ mount å¹¶æ›¿æ¢å†…å®¹ï¼‰
          if (root && root.querySelector('.boot-loader')) {
              root.innerHTML = `
                <div style="height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px; background:#020617;">
                    <div style="font-size:48px; margin-bottom:20px;">ğŸ“¡</div>
                    <h2 style="color:#f87171; font-weight:900; margin-bottom:10px;">CONNECTION TIMEOUT</h2>
                    <p style="color:#94a3b8; max-width:300px; font-size:14px; margin-bottom:30px;">Initialization took too long. This might be due to a slow network or a Firebase configuration issue.</p>
                    <button onclick="location.reload()" style="padding:12px 24px; background:#1e293b; color:white; border:1px solid #334155; border-radius:12px; font-weight:bold; cursor:pointer;">RETRY CONNECTION</button>
                    <p style="margin-top:20px; font-size:10px; color:#475569; font-family:monospace;">Check console for detailed logs</p>
                </div>`;
          }
      }, 8000);
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #f8fafc; margin: 0; overflow-x: hidden; min-height: 100vh; }
        .boot-loader { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.0.0",
    "react-dom": "https://esm.sh/react-dom@19.0.0",
    "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
    "@google/genai": "https://esm.sh/@google/genai@1.34.0",
    "firebase/app": "https://esm.sh/firebase@11.0.1/app",
    "firebase/database": "https://esm.sh/firebase@11.0.1/database",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "firebase/": "https://esm.sh/firebase@^12.7.0/"
  }
}
</script>
    <script>window.process = { env: { API_KEY: "" } };</script>
</head>
<body>
    <div id="root">
        <div class="boot-loader">
            <div style="width: 40px; height: 40px; border: 3px solid #4f46e5; border-top-color: transparent; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
            <p style="margin-top: 20px; font-weight: 900; letter-spacing: 0.4em; color: #4f46e5; font-size: 10px; text-transform: uppercase;">Initializing Neural Link...</p>
        </div>
    </div>
    <script type="module" src="./index.tsx"></script>
</body>
</html>
